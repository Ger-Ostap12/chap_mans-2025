# Инструкция по запуску приложения

## Запуск сервера

1. Активируйте виртуальное окружение:
```bash
source venv/bin/activate
```

2. Запустите сервер FastAPI:
```bash
python3 main_unified.py
```

Сервер будет доступен по адресу: http://localhost:8000

## Использование фронтенда

1. Откройте браузер и перейдите по адресу: http://localhost:8000
2. Загрузите файл с данными клиентов (поддерживаются CSV, Excel .xlsx/.xls, JSON)
3. Разрешите геолокацию или введите адрес вручную
4. Нажмите "Построить маршрут"
5. На карте отобразится оптимальный маршрут
6. Используйте кнопку "Экспортировать" для скачивания отчета

## Поддерживаемые форматы файлов

### CSV файлы
CSV файл должен содержать следующие колонки:
- Номер объекта (или id)
- Адрес объекта (или address)
- Географическая широта (или lat)
- Географическая долгота (или lon)
- Время начала рабочего дня (или work_start)
- Время окончания рабочего дня (или work_end)
- Время начала обеда (или lunch_start)
- Время окончания обеда (или lunch_end)
- Уровень клиента (или client_level)

### Excel файлы (.xlsx, .xls)
Excel файлы должны содержать те же колонки, что и CSV файлы.

### JSON файлы
JSON файл должен содержать массив объектов с соответствующими полями.

## Новые возможности

### Расширенная обработка файлов
- Автоматическое сохранение в базу данных
- Поддержка Excel файлов
- Обработка ошибок и валидация данных
- Шифрование конфиденциальных данных

### Управление пользователями
- Регистрация новых пользователей
- Авторизация с шифрованием номеров телефонов
- Управление периодами пребывания

### Управление локациями
- Отметка посещения локаций
- Получение списка доступных локаций
- Статистика посещений

## API эндпоинты

### Основные эндпоинты
- `POST /api/upload-advanced` - Расширенная загрузка файлов
- `POST /api/register` - Регистрация пользователя
- `POST /api/login` - Авторизация пользователя
- `GET /api/user/{user_id}/locations` - Получение локаций пользователя
- `POST /api/location/visit` - Отметка посещения локации
- `POST /api/stay-period` - Установка периода пребывания
- `GET /api/stay-period/{user_id}` - Получение информации о периоде

### Тестовые файлы
- `test_data.csv` - Простые данные для тестирования
- `test_data_advanced.csv` - Расширенные данные с полной структурой

## API документация

Доступна по адресу: http://localhost:8000/docs
